{
  "modules": [
    {
      "file": "src/__init__.py",
      "description": "パッケージ初期化ファイル",
      "exports": []
    },
    {
      "file": "src/main.py",
      "description": "GUIアプリケーションのエントリーポイント",
      "classes": [
        {
          "name": "SingleInstanceLock",
          "description": "アプリの多重起動を防止するロッククラス",
          "methods": [
            "_is_process_running: 指定PIDのプロセス動作確認（Windows/Unix対応）",
            "acquire: ロック取得（成功/既に起動中を返す）",
            "release: ロック解放"
          ]
        },
        {
          "name": "CircularProgress",
          "description": "円形プログレスバー（透明背景、白縁黒文字）",
          "methods": [
            "set: 進捗を設定 (0.0 ~ 1.0)",
            "get: 現在の進捗を取得",
            "reset: リセット"
          ]
        },
        {
          "name": "Toast",
          "description": "トースト通知",
          "methods": []
        },
        {
          "name": "CustomDialog",
          "description": "カスタムダイアログの基底クラス",
          "methods": [
            "add_button: ボタンを追加"
          ]
        },
        {
          "name": "BackgroundRemoverApp",
          "description": "メインアプリケーションクラス（CustomTkinter GUI）",
          "methods": [
            "_setup_ui: UIコンポーネントの構築",
            "_set_window_icon: タスクバーアイコン設定",
            "_select_input: 入力ファイル選択ダイアログ",
            "_save_output_file: 出力ファイル保存",
            "_start_processing: 処理開始（別スレッド起動）",
            "_process_video: 動画処理の実行",
            "_on_progress: 進捗更新コールバック",
            "_on_complete: 処理完了時の処理",
            "_on_error: エラー発生時の処理",
            "_on_cancelled: キャンセル時の処理",
            "_show_gpu_warning: GPU未検出警告の表示",
            "_show_save_complete_dialog: 保存完了ダイアログ（3秒自動クローズ）",
            "_create_checkerboard: 市松模様（チェッカーボード）画像を生成",
            "_extract_processed_thumbnail: 処理済み動画からサムネイル抽出（市松模様背景）"
          ]
        }
      ],
      "functions": [
        {
          "name": "main",
          "description": "アプリケーションのエントリーポイント（多重起動チェック付き）"
        },
        {
          "name": "_bring_existing_window_to_front",
          "description": "既存のウィンドウを前面に出す（macOS/Windows対応）"
        }
      ]
    },
    {
      "file": "src/video_processor.py",
      "description": "動画の読み込み・処理・出力ロジック",
      "classes": [
        {
          "name": "OutputParams",
          "description": "出力パラメータを格納するデータクラス（ファイルサイズ最適化用）",
          "fields": ["width", "height", "fps", "original_width", "original_height", "original_fps", "is_adjusted"],
          "properties": ["resolution_adjusted", "fps_adjusted"]
        },
        {
          "name": "VideoInfo",
          "description": "動画情報を格納するデータクラス",
          "fields": ["width", "height", "fps", "frame_count", "duration", "has_audio"]
        },
        {
          "name": "ProcessingCancelled",
          "description": "処理キャンセル時の例外クラス"
        },
        {
          "name": "VideoProcessor",
          "description": "動画処理のメインクラス",
          "methods": [
            "process: 動画全体の処理（入力→背景除去→出力）",
            "cancel: 処理のキャンセル要求",
            "pause: 処理を一時停止",
            "resume: 処理を再開",
            "_process_frames: フレームごとの処理（キャンセル確認付き）",
            "_create_rgba_image: RGBA画像の生成",
            "_create_prores_video: ProRes 4444動画の生成（音声自動含む、解像度/fps調整対応）"
          ]
        }
      ],
      "functions": [
        {
          "name": "estimate_prores_size_mb",
          "description": "ProRes 4444の推定ファイルサイズを計算"
        },
        {
          "name": "calculate_optimal_params",
          "description": "1023MB以下に収まる最適なパラメータを計算"
        },
        {
          "name": "get_video_info",
          "description": "動画のメタ情報を取得（音声有無を含む）"
        },
        {
          "name": "find_ffmpeg",
          "description": "ffmpegの実行ファイルを検索"
        },
        {
          "name": "_check_audio_stream",
          "description": "動画に音声ストリームがあるか確認"
        }
      ],
      "constants": [
        "MAX_FILE_SIZE_MB: ファイルサイズ上限（1023MB）"
      ]
    },
    {
      "file": "src/rvm_model.py",
      "description": "RobustVideoMattingモデルの管理",
      "classes": [
        {
          "name": "RVMModel",
          "description": "RVMモデルのロード・推論を担当",
          "methods": [
            "load: モデルファイルをロード",
            "reset_state: recurrent状態をリセット",
            "is_loaded: モデルがロード済みか確認",
            "process_frame: 1フレームを処理してマスク生成",
            "set_downsample_ratio: ダウンサンプル比率を設定"
          ]
        }
      ],
      "functions": [
        {
          "name": "download_model",
          "description": "モデルをGitHubからダウンロード"
        }
      ],
      "constants": [
        "MODEL_URLS: モデルのダウンロードURL",
        "DEFAULT_MODEL_DIR: デフォルトモデルディレクトリ"
      ]
    },
    {
      "file": "src/utils.py",
      "description": "共通ユーティリティ関数",
      "classes": [
        {
          "name": "DeviceInfo",
          "description": "デバイス情報を格納するデータクラス",
          "fields": ["device", "name", "is_gpu", "warning"]
        }
      ],
      "functions": [
        {
          "name": "get_device",
          "description": "最適なデバイス（CUDA/MPS/CPU）を取得"
        },
        {
          "name": "get_device_info",
          "description": "デバイスの詳細情報を取得"
        },
        {
          "name": "is_supported_video",
          "description": "サポートされている動画形式か判定"
        },
        {
          "name": "get_output_path",
          "description": "出力ファイルパスを生成"
        },
        {
          "name": "ensure_directory",
          "description": "ディレクトリが存在しなければ作成"
        },
        {
          "name": "get_file_size_mb",
          "description": "ファイルサイズをMB単位で取得"
        },
        {
          "name": "format_time",
          "description": "秒数を時:分:秒形式にフォーマット"
        }
      ],
      "constants": [
        "SUPPORTED_INPUT_EXTENSIONS: サポートする入力拡張子",
        "OUTPUT_EXTENSION: 出力拡張子（.mov）"
      ]
    }
  ]
}
